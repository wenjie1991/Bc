<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract barcode from sequences — bc_extract • CellBarcode</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract barcode from sequences — bc_extract"><meta property="og:description" content="bc_extract identifies the barcodes (and UMI) from the sequences using
regular expressions.  pattern and pattern_type arguments are
necessary, which provide the barcode (and UMI) pattern and their location
within the sequences."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-NY9M0DHR4F"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NY9M0DHR4F');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CellBarcode</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Barcode_in_10X_scRNASeq.html">Get barcode from 10X Genomics scRNASeq data</a>
    </li>
    <li>
      <a href="../articles/UMI_VDJ_Barcode.html">Analyzing Cellular DNA Barcode with CellBarcode</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract barcode from sequences</h1>
    
    <div class="hidden name"><code>bc_extract.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>bc_extract</code> identifies the barcodes (and UMI) from the sequences using
regular expressions.  <code>pattern</code> and <code>pattern_type</code> arguments are
necessary, which provide the barcode (and UMI) pattern and their location
within the sequences.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bc_extract</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxLDist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pattern_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>barcode <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="fl">1</span>, ins <span class="op">=</span> <span class="fl">99</span>, del <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frame</span></span>
<span><span class="fu">bc_extract</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxLDist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pattern_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>barcode <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="fl">1</span>, ins <span class="op">=</span> <span class="fl">99</span>, del <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ShortReadQ</span></span>
<span><span class="fu">bc_extract</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxLDist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pattern_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>barcode <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="fl">1</span>, ins <span class="op">=</span> <span class="fl">99</span>, del <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DNAStringSet</span></span>
<span><span class="fu">bc_extract</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxLDist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pattern_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>barcode <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="fl">1</span>, ins <span class="op">=</span> <span class="fl">99</span>, del <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for integer</span></span>
<span><span class="fu">bc_extract</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxLDist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pattern_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>barcode <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="fl">1</span>, ins <span class="op">=</span> <span class="fl">99</span>, del <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for character</span></span>
<span><span class="fu">bc_extract</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxLDist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pattern_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>barcode <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="fl">1</span>, ins <span class="op">=</span> <span class="fl">99</span>, del <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for list</span></span>
<span><span class="fu">bc_extract</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxLDist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pattern_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>barcode <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="fl">1</span>, ins <span class="op">=</span> <span class="fl">99</span>, del <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A single or a list of fastq file, ShortReadQ, DNAStringSet,
data.frame, or named integer.</p></dd>


<dt>pattern</dt>
<dd><p>A string or a string vector with the same number of files,
specifying the regular expression with capture. It matchs the barcode (and
UMI) with capture pattern.</p></dd>


<dt>sample_name</dt>
<dd><p>A string vector, applicable when <code>x</code> is a list or
fastq file vector. This argument specifies the sample names. If not provided,
the function will look for sample name in the rownames of metadata,
the fastqfile name or the <code>list</code> names.</p></dd>


<dt>metadata</dt>
<dd><p>A <code>data.frame</code> with sample names as the row names, with 
each metadata record by column, specifying the sample characteristics.</p></dd>


<dt>maxLDist</dt>
<dd><p>An integer. The minimun mismatch threshold for barcode
matching, when maxLDist is 0, the <code><a href="https://stringr.tidyverse.org/reference/str_match.html" class="external-link">str_match</a></code>  is
invoked for barcode matching which is faster, otherwise
<code><a href="https://rdrr.io/r/utils/aregexec.html" class="external-link">aregexec</a></code> is invoked and the <code>costs</code> parameters can
be used to specifying the weight of the distance calculation.</p></dd>


<dt>pattern_type</dt>
<dd><p>A vector. It defines the barcode (and UMI) capture
group. See Details.</p></dd>


<dt>costs</dt>
<dd><p>A named list, applicable when maxLDist &gt; 0, specifying the
weight of each mismatch events while extracting the barcodes.  The list
element name have to be <code>sub</code> (substitution), <code>ins</code> (insertion) and
<code>del</code> (deletion). The default value is <code>list(sub = 1, ins = 99, del
= 99)</code>.  See <code><a href="https://rdrr.io/r/utils/aregexec.html" class="external-link">aregexec</a></code> for more detail information.</p></dd>


<dt>ordered</dt>
<dd><p>A logical value. If the value is true, the return barcodes
(UMI-barcode tags) are sorted by the reads counts.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>This function returns a BarcodeObj object if the input is a <code>list</code> or a
<code>vector</code> of Fastq files, otherwise it returns a <code>data.frame.</code> In
the later case
the <code>data.frame</code> has columns:</p><ol><li><p><code>umi_seq</code> (optional): UMI sequence, applicable when there is UMI
    in `pattern` and `pattern_type` argument.</p></li>
<li><p><code>barcode_seq</code>: barcode sequence.</p></li>
<li><p><code>count</code>: reads number.</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>pattern</code> argument is a regular expression, the capture operation
<code>()</code> identifying the barcode or UMI. <code>pattern_type</code> argument
annotates capture, denoting the UMI or the barcode captured pattern. In the
example:</p><div class="sourceCode"><pre><code>
([ACTG]{3})TCGATCGATCGA([ACTG]+)ATCGATCGATC
|---------| starts with 3 base pairs UMI.
           |----------| constant sequence in the backbone.
                       |-------| flexible barcode sequences.
                                |---------| 3' constant sequence.
</code></pre></div>

<p>In UMI part <code>[ACGT]{3}</code>, <code>[ACGT]</code> means it can be one of
the "A", "C", "G" and "T", and <code>{3}</code> means it repeats 3 times. 
In the barcode pattern <code>[ACGT]+</code>, the <code>+</code> denotes
that there is at least one of the <code>A</code> or <code>C</code> or <code>G</code> or
<code>T.</code></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fq_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"simple.fq"</span>, package<span class="op">=</span><span class="st">"CellBarcode"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/ShortRead" class="external-link">ShortRead</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># barcode from fastq file</span></span></span>
<span class="r-in"><span><span class="fu">bc_extract</span><span class="op">(</span><span class="va">fq_file</span>, pattern <span class="op">=</span> <span class="st">"AAAAA(.*)CCCCC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    barcode_seq count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;char&gt; &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          GG     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># barcode from ShortReadQ object</span></span></span>
<span class="r-in"><span><span class="va">sr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ShortRead/man/readFastq.html" class="external-link">readFastq</a></span><span class="op">(</span><span class="va">fq_file</span><span class="op">)</span>  <span class="co"># ShortReadQ</span></span></span>
<span class="r-in"><span><span class="fu">bc_extract</span><span class="op">(</span><span class="va">sr</span>, pattern <span class="op">=</span> <span class="st">"AAAAA(.*)CCCCC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    barcode_seq count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;char&gt; &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          GG     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># barcode from DNAStringSet object</span></span></span>
<span class="r-in"><span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ShortRead/man/ShortRead-class.html" class="external-link">sread</a></span><span class="op">(</span><span class="va">sr</span><span class="op">)</span>  <span class="co"># DNAStringSet</span></span></span>
<span class="r-in"><span><span class="fu">bc_extract</span><span class="op">(</span><span class="va">ds</span>, pattern <span class="op">=</span> <span class="st">"AAAAA(.*)CCCCC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    barcode_seq count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;char&gt; &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          GG     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># barcode from integer vector</span></span></span>
<span class="r-in"><span><span class="va">iv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ShortRead/man/tables.html" class="external-link">tables</a></span><span class="op">(</span><span class="va">ds</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span><span class="op">$</span><span class="va">top</span> <span class="co"># integer vector</span></span></span>
<span class="r-in"><span><span class="fu">bc_extract</span><span class="op">(</span><span class="va">iv</span>, pattern <span class="op">=</span> <span class="st">"AAAAA(.*)CCCCC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    barcode_seq count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;char&gt; &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          GG     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># barcode from data.frame </span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">iv</span><span class="op">)</span>, freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">iv</span><span class="op">)</span><span class="op">)</span> <span class="co"># data.frame</span></span></span>
<span class="r-in"><span><span class="fu">bc_extract</span><span class="op">(</span><span class="va">df</span>, pattern <span class="op">=</span> <span class="st">"AAAAA(.*)CCCCC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    barcode_seq count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;char&gt; &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          GG     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># barcode from list of DNAStringSet</span></span></span>
<span class="r-in"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sample1 <span class="op">=</span> <span class="va">ds</span>, sample2 <span class="op">=</span> <span class="va">ds</span><span class="op">)</span> <span class="co"># list</span></span></span>
<span class="r-in"><span><span class="fu">bc_extract</span><span class="op">(</span><span class="va">l</span>, pattern <span class="op">=</span> <span class="st">"AAAAA(.*)CCCCC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bonjour le monde, This is a BarcodeObj.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It contains: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @metadata: 2 field(s) available:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_read_count  barcode_read_count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @messyBc: 2 sample(s) for raw barcodes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     In sample $sample1 there are: 1 Tags</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     In sample $sample2 there are: 1 Tags </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract UMI and barcode</span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"ACTTCGATCGATCGAAAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"AATTCGATCGATCGAAGAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"CCTTCGATCGATCGAAGAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"TTTTCGATCGATCGAAAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"AAATCGATCGATCGAAGAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"CCCTCGATCGATCGAAGAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"GGGTCGATCGATCGAAAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"GGATCGATCGATCGAAGAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"ACTTCGATCGATCGAACAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"GGTTCGATCGATCGACGAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"GCGTCCATCGATCGAAGAAGATCGATCGATC"</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">6</span>, <span class="fl">4</span> , <span class="fl">6</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> </span></span>
<span class="r-in"><span><span class="co"># barcode backbone with UMI and barcode</span></span></span>
<span class="r-in"><span><span class="va">pattern</span> <span class="op">&lt;-</span> <span class="st">"([ACTG]{3})TCGATCGATCGA([ACTG]+)ATCGATCGATC"</span></span></span>
<span class="r-in"><span><span class="fu">bc_extract</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>test <span class="op">=</span> <span class="va">d1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    <span class="va">pattern</span>, </span></span>
<span class="r-in"><span>    sample_name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    pattern_type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>UMI<span class="op">=</span><span class="fl">1</span>, barcode<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bonjour le monde, This is a BarcodeObj.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It contains: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @metadata: 2 field(s) available:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_read_count  barcode_read_count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @messyBc: 1 sample(s) for raw barcodes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     In sample $test there are: 10 Tags </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Wenjie Sun, Anne-Marie Lyne, Leila Perie.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

