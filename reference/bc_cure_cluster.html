<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Clean barcodes by editing distance — bc_cure_cluster • CellBarcode</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Clean barcodes by editing distance — bc_cure_cluster"><meta property="og:description" content="bc_cure_cluster performs clustering of barcodes by editing distance,
and remove the minority barcodes with a similar sequence. This function is only
applicable for the BarcodeObj object with a cleanBc slot. The barcodes
with a smaller reads count will be removed."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-NY9M0DHR4F"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NY9M0DHR4F');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CellBarcode</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Barcode_in_10X_scRNASeq.html">Get barcode from 10X Genomics scRNASeq data</a>
    </li>
    <li>
      <a href="../articles/UMI_VDJ_Barcode.html">Analyzing Cellular DNA Barcode with CellBarcode</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Clean barcodes by editing distance</h1>
    
    <div class="hidden name"><code>bc_cure_cluster.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>bc_cure_cluster</code> performs clustering of barcodes by editing distance,
and remove the minority barcodes with a similar sequence. This function is only
applicable for the BarcodeObj object with a <code>cleanBc</code> slot. The barcodes
with a smaller reads count will be removed.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bc_cure_cluster</span><span class="op">(</span></span>
<span>  <span class="va">barcodeObj</span>,</span>
<span>  dist_threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  depth_fold_threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  dist_method <span class="op">=</span> <span class="st">"hamm"</span>,</span>
<span>  cluster_method <span class="op">=</span> <span class="st">"greedy"</span>,</span>
<span>  count_threshold <span class="op">=</span> <span class="fl">1e+09</span>,</span>
<span>  dist_costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>replace <span class="op">=</span> <span class="fl">1</span>, insert <span class="op">=</span> <span class="fl">1</span>, delete <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for BarcodeObj</span></span>
<span><span class="fu">bc_cure_cluster</span><span class="op">(</span></span>
<span>  <span class="va">barcodeObj</span>,</span>
<span>  dist_threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  depth_fold_threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  dist_method <span class="op">=</span> <span class="st">"hamm"</span>,</span>
<span>  cluster_method <span class="op">=</span> <span class="st">"greedy"</span>,</span>
<span>  count_threshold <span class="op">=</span> <span class="fl">1e+07</span>,</span>
<span>  dist_costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>replace <span class="op">=</span> <span class="fl">1</span>, insert <span class="op">=</span> <span class="fl">1</span>, delete <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>barcodeObj</dt>
<dd><p>A BarcodeObj object.</p></dd>


<dt>dist_threshold</dt>
<dd><p>A single integer, or vector of integers with the length of
sample number, specifying the editing distance threshold for defining two
similar barcode sequences. If the input is a vector, each value in the vector
relates to one sample according to its order in <code>BarcodeObj</code> object.
The sequences with editing distance equal to or less than the threshold will be
considered similar barcodes.</p></dd>


<dt>depth_fold_threshold</dt>
<dd><p>A single numeric or vector of numeric with the
length of sample number, specifying the depth fold change threshold of
removing the similar minority barcode. The majority of barcodes should have at
least <code>depth_fold_threshold</code> times of reads of the similar minotiry
one, to remove the minority similar barcode. (TODO: more precise
description)</p></dd>


<dt>dist_method</dt>
<dd><p>A  character string, specifying the editing distance 
used for evaluating barcode similarity. It can be "hamm" for Hamming
distance or "leven" for Levenshtein distance.</p></dd>


<dt>cluster_method</dt>
<dd><p>A character string specifying the algorithm used to
perform the clustering of barcodes. Currently only "greedy" is
available, in this case, The most and the least abundant barcode will
be used for comparing, the least abundant barcode is preferentially removed.</p></dd>


<dt>count_threshold</dt>
<dd><p>An integer, read depth threshold to consider a barcode
as a true barcode. If a barcode with a count higher than this threshold
it will not be removed, even if the barcode is similar to a more abundant one.
Default is 1e9.</p></dd>


<dt>dist_costs</dt>
<dd><p>A list, the cost of the events of distance algorithm, 
applicable when Levenshtein distance is applied. The
names of vector have to be <code>insert</code>, <code>delete</code> and <code>replace</code>,
specifying the weight of insertion, deletion, and replacement events
respectively. The default cost for each event is 1.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A BarcodeObj object with cleanBc slot updated.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bc_obj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"ACTTCGATCGATCGAAAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"AATTCGATCGATCGAAGAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"CCTTCGATCGATCGAAGAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"TTTTCGATCGATCGAAAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"AAATCGATCGATCGAAGAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"CCCTCGATCGATCGAAGAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"GGGTCGATCGATCGAAAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"GGATCGATCGATCGAAGAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"ACTTCGATCGATCGAACAAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"GGTTCGATCGATCGACGAGATCGATCGATC"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"GCGTCCATCGATCGAAGAAGATCGATCGATC"</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">6</span>, <span class="fl">4</span> , <span class="fl">6</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pattern</span> <span class="op">&lt;-</span> <span class="st">"([ACTG]{3})TCGATCGATCGA([ACTG]+)ATCGATCGATC"</span></span></span>
<span class="r-in"><span><span class="va">bc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="bc_extract.html">bc_extract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>test <span class="op">=</span> <span class="va">d1</span><span class="op">)</span>, <span class="va">pattern</span>, sample_name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    pattern_type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>UMI<span class="op">=</span><span class="fl">1</span>, barcode<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Remove barcodes with depth &lt; 5</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">bc_cured</span> <span class="op">&lt;-</span> <span class="fu"><a href="bc_cure_depth.html">bc_cure_depth</a></span><span class="op">(</span><span class="va">bc_obj</span>, depth<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> bc_cure_depth: isUpdate is TRUE, update the cleanBc.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bonjour le monde, This is a BarcodeObj.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It contains: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @metadata: 3 field(s) available:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_read_count  barcode_read_count  depth_cutoff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @messyBc: 1 sample(s) for raw barcodes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     In sample $test there are: 10 Tags</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @cleanBc: 1 samples for cleaned barcodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     In sample $test there are: 4 barcodes </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Do the clustering, remove the less abundant barcodes</span></span></span>
<span class="r-in"><span><span class="co"># one by hamming distance &lt;= 1 </span></span></span>
<span class="r-in"><span><span class="fu">bc_cure_cluster</span><span class="op">(</span><span class="va">bc_cured</span>, dist_threshold <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bonjour le monde, This is a BarcodeObj.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It contains: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @metadata: 3 field(s) available:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_read_count  barcode_read_count  depth_cutoff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @messyBc: 1 sample(s) for raw barcodes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     In sample $test there are: 10 Tags</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @cleanBc: 1 samples for cleaned barcodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     In sample $test there are: 2 barcodes </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Levenshtein distance &lt;= 1</span></span></span>
<span class="r-in"><span><span class="fu">bc_cure_cluster</span><span class="op">(</span><span class="va">bc_cured</span>, dist_threshold <span class="op">=</span> <span class="fl">2</span>, dist_method <span class="op">=</span> <span class="st">"leven"</span>,</span></span>
<span class="r-in"><span>    dist_costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"insert"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"replace"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"delete"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bonjour le monde, This is a BarcodeObj.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It contains: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @metadata: 3 field(s) available:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_read_count  barcode_read_count  depth_cutoff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @messyBc: 1 sample(s) for raw barcodes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     In sample $test there are: 10 Tags</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @cleanBc: 1 samples for cleaned barcodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     In sample $test there are: 1 barcodes </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Wenjie Sun, Anne-Marie Lyne, Leila Perie.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

